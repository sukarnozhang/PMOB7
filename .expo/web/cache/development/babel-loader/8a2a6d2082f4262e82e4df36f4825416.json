{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/sukarno.zhanggmail.com/Desktop/PMOB6/screens/AccountScreen.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Switch from \"react-native-web/dist/exports/Switch\";\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport { commonStyles, lightStyles } from \"../styles/commonStyles\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport axios from \"axios\";\nimport { API, API_WHOAMI } from \"../constants/API\";\nexport default function AccountScreen(_ref) {\n  var _this = this;\n\n  var navigation = _ref.navigation;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      username = _useState2[0],\n      setUsername = _useState2[1];\n\n  var styles = _objectSpread(_objectSpread({}, commonStyles), lightStyles);\n\n  function getUsername() {\n    var token, response;\n    return _regeneratorRuntime.async(function getUsername$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            console.log(\"---- Getting user name ----\");\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"token\"));\n\n          case 3:\n            token = _context.sent;\n            console.log(\"Token is \" + token);\n            _context.prev = 5;\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(axios.get(API + API_WHOAMI, {\n              headers: {\n                Authorization: \"JWT \" + token\n              }\n            }));\n\n          case 8:\n            response = _context.sent;\n            console.log(\"Got user name!\");\n            setUsername(response.data.username);\n            _context.next = 17;\n            break;\n\n          case 13:\n            _context.prev = 13;\n            _context.t0 = _context[\"catch\"](5);\n            console.log(\"Error getting user name\");\n\n            if (_context.t0.response) {\n              console.log(_context.t0.response.data);\n\n              if (_context.t0.response.data.status_code === 401) {\n                signOut();\n                navigation.navigate(\"SignInSignUp\");\n              }\n            } else {\n              console.log(_context.t0);\n            }\n\n          case 17:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[5, 13]], Promise);\n  }\n\n  function signOut() {\n    AsyncStorage.removeItem(\"token\");\n    navigation.navigate(\"SignInSignUp\");\n  }\n\n  useEffect(function () {\n    console.log(\"Setting up nav listener\");\n    var removeListener = navigation.addListener(\"focus\", function () {\n      console.log(\"Running nav listener\");\n      setUsername(React.createElement(ActivityIndicator, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 19\n        }\n      }));\n      getUsername();\n    });\n    getUsername();\n    return removeListener;\n  }, []);\n  return React.createElement(View, {\n    style: [styles.container, {\n      alignItems: \"center\"\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    style: {\n      marginTop: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }\n  }, \"Account Screen\"), React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }\n  }, username));\n}","map":{"version":3,"sources":["/Users/sukarno.zhanggmail.com/Desktop/PMOB6/screens/AccountScreen.js"],"names":["React","useState","useEffect","commonStyles","lightStyles","AsyncStorage","axios","API","API_WHOAMI","AccountScreen","navigation","username","setUsername","styles","getUsername","console","log","getItem","token","get","headers","Authorization","response","data","status_code","signOut","navigate","removeItem","removeListener","addListener","container","alignItems","marginTop"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;;;;;;;;AAEA,SAASC,YAAT,EAAuBC,WAAvB;AACA,OAAOC,YAAP,MAAyB,2CAAzB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,GAAT,EAAcC,UAAd;AAEA,eAAe,SAASC,aAAT,OAAuC;AAAA;;AAAA,MAAdC,UAAc,QAAdA,UAAc;;AAEpD,kBAAgCT,QAAQ,CAAC,IAAD,CAAxC;AAAA;AAAA,MAAOU,QAAP;AAAA,MAAiBC,WAAjB;;AAEA,MAAMC,MAAM,mCAAQV,YAAR,GAAyBC,WAAzB,CAAZ;;AAEA,WAAeU,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AACEC,YAAAA,OAAO,CAACC,GAAR,CAAY,6BAAZ;AADF;AAAA,6CAEsBX,YAAY,CAACY,OAAb,CAAqB,OAArB,CAFtB;;AAAA;AAEQC,YAAAA,KAFR;AAGEH,YAAAA,OAAO,CAACC,GAAR,eAAwBE,KAAxB;AAHF;AAAA;AAAA,6CAK2BZ,KAAK,CAACa,GAAN,CAAUZ,GAAG,GAAGC,UAAhB,EAA4B;AACjDY,cAAAA,OAAO,EAAE;AAAEC,gBAAAA,aAAa,WAASH;AAAxB;AADwC,aAA5B,CAL3B;;AAAA;AAKUI,YAAAA,QALV;AAQIP,YAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AACAJ,YAAAA,WAAW,CAACU,QAAQ,CAACC,IAAT,CAAcZ,QAAf,CAAX;AATJ;AAAA;;AAAA;AAAA;AAAA;AAWII,YAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;;AACA,gBAAI,YAAMM,QAAV,EAAoB;AAClBP,cAAAA,OAAO,CAACC,GAAR,CAAY,YAAMM,QAAN,CAAeC,IAA3B;;AACA,kBAAI,YAAMD,QAAN,CAAeC,IAAf,CAAoBC,WAApB,KAAoC,GAAxC,EAA6C;AAC3CC,gBAAAA,OAAO;AACPf,gBAAAA,UAAU,CAACgB,QAAX,CAAoB,cAApB;AACD;AACF,aAND,MAMO;AACLX,cAAAA,OAAO,CAACC,GAAR;AACD;;AApBL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAyBA,WAASS,OAAT,GAAmB;AACjBpB,IAAAA,YAAY,CAACsB,UAAb,CAAwB,OAAxB;AACAjB,IAAAA,UAAU,CAACgB,QAAX,CAAoB,cAApB;AACD;;AAEDxB,EAAAA,SAAS,CAAC,YAAM;AACda,IAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AAEA,QAAMY,cAAc,GAAGlB,UAAU,CAACmB,WAAX,CAAuB,OAAvB,EAAgC,YAAM;AAC3Dd,MAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AACAJ,MAAAA,WAAW,CAAC,oBAAC,iBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAD,CAAX;AACAE,MAAAA,WAAW;AACZ,KAJsB,CAAvB;AAKAA,IAAAA,WAAW;AACX,WAAOc,cAAP;AACD,GAVQ,EAUN,EAVM,CAAT;AAYA,SACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE,CAACf,MAAM,CAACiB,SAAR,EAAmB;AAAEC,MAAAA,UAAU,EAAE;AAAd,KAAnB,CAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE;AAACC,MAAAA,SAAS,EAAE;AAAZ,KAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,EAIE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGrB,QADH,CAJF,CADF;AAUD","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { ActivityIndicator, TouchableOpacity, Text, View, Switch, Animated, TouchableWithoutFeedback } from \"react-native\";\nimport { commonStyles, lightStyles } from \"../styles/commonStyles\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport axios from \"axios\";\nimport { API, API_WHOAMI } from \"../constants/API\";\n\nexport default function AccountScreen({ navigation }) {\n\n  const [username, setUsername] = useState(null);\n\n  const styles = { ...commonStyles, ...lightStyles };\n\n  async function getUsername() {\n    console.log(\"---- Getting user name ----\");\n    const token = await AsyncStorage.getItem(\"token\");\n    console.log(`Token is ${token}`);\n    try {\n      const response = await axios.get(API + API_WHOAMI, {\n        headers: { Authorization: `JWT ${token}` },\n      });\n      console.log(\"Got user name!\");\n      setUsername(response.data.username);\n    } catch (error) {\n      console.log(\"Error getting user name\");\n      if (error.response) {\n        console.log(error.response.data);\n        if (error.response.data.status_code === 401) {\n          signOut();\n          navigation.navigate(\"SignInSignUp\")\n        }\n      } else {\n        console.log(error);\n      }\n      // We should probably go back to the login screen???\n    }\n  }\n\n  function signOut() {\n    AsyncStorage.removeItem(\"token\");\n    navigation.navigate(\"SignInSignUp\");\n  }\n\n  useEffect(() => {\n    console.log(\"Setting up nav listener\");\n    // Check for when we come back to this screen\n    const removeListener = navigation.addListener(\"focus\", () => {\n      console.log(\"Running nav listener\");\n      setUsername(<ActivityIndicator />);\n      getUsername();\n    });\n    getUsername();\n    return removeListener;\n  }, []);\n\n  return (\n    <View style={[styles.container, { alignItems: \"center\" }]}>\n      <Text style={{marginTop: 20}}>\n        Account Screen\n      </Text>\n      <Text>\n        {username}\n      </Text>\n    </View>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}